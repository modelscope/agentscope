<!-- layout.html -->
<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Service &mdash; AgentScope  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=c9484b72" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Memory" href="205-memory.html" />
    <link rel="prev" title="Model" href="203-model.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" > 

          
          
          <a href="../index.html" class="icon icon-home">
            AgentScope
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div> <!-- language_selector.html -->
<div class="language-selector">
    <a href="../../en/tutorial/204-service.html">English</a></li> |
    <a href="../../zh_CN/tutorial/204-service.html">中文</a></li>
</div> 
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">AgentScope Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="advance.html">Advanced Exploration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="201-agent.html">Customizing Your Own Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="202-pipeline.html">Pipeline and MsgHub</a></li>
<li class="toctree-l2"><a class="reference internal" href="203-model.html">Model</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="205-memory.html">Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="206-prompt.html">Prompt Engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="207-monitor.html">Monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="208-distribute.html">Distribution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Get Involved</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AgentScope API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.html">agentscope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.message.html">agentscope.message</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.models.html">agentscope.models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.agents.html">agentscope.agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.memory.html">agentscope.memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.pipelines.html">agentscope.pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.service.html">agentscope.service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.rpc.html">agentscope.rpc</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.web.html">agentscope.web</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.prompt.html">agentscope.prompt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../agentscope.utils.html">agentscope.utils</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">AgentScope</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="advance.html">Advanced Exploration</a></li>
      <li class="breadcrumb-item active">Service</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/204-service.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="service">
<span id="service-en"></span><h1>Service<a class="headerlink" href="#service" title="Link to this heading"></a></h1>
<p>Service function is a set of multi-functional utility tools that can be
used to enhance the capabilities of agents, such as executing Python code,
web search, file operations, and more.
This tutorial provides an overview of the service functions available in
AgentScope and how to use them to enhance the capabilities of your agents.</p>
<section id="built-in-service-functions">
<h2>Built-in Service Functions<a class="headerlink" href="#built-in-service-functions" title="Link to this heading"></a></h2>
<p>The following table outlines the various Service functions by type. These functions can be called using <code class="docutils literal notranslate"><span class="pre">agentscope.service.{function_name}</span></code>.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Service Scene</p></th>
<th class="head"><p>Service Function Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Code</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">execute_python_code</span></code></p></td>
<td><p>Execute a piece of Python code, optionally inside a Docker container.</p></td>
</tr>
<tr class="row-odd"><td><p>Retrieval</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">retrieve_from_list</span></code></p></td>
<td><p>Retrieve a specific item from a list based on given criteria.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">cos_sim</span></code></p></td>
<td><p>Compute the cosine similarity between two different embeddings.</p></td>
</tr>
<tr class="row-odd"><td><p>SQL Query</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_mysql</span></code></p></td>
<td><p>Execute SQL queries on a MySQL database and return results.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_sqlite</span></code></p></td>
<td><p>Execute SQL queries on a SQLite database and return results.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">query_mongodb</span></code></p></td>
<td><p>Perform queries or operations on a MongoDB collection.</p></td>
</tr>
<tr class="row-even"><td><p>Text Processing</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">summarization</span></code></p></td>
<td><p>Summarize a piece of text using a large language model to highlight its main points.</p></td>
</tr>
<tr class="row-odd"><td><p>Web</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bing_search</span></code></p></td>
<td><p>Perform bing search</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">google_search</span></code></p></td>
<td><p>Perform google search</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">arxiv_search</span></code></p></td>
<td><p>Perform arXiv search</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">download_from_url</span></code></p></td>
<td><p>Download file from given URL.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">load_web</span></code></p></td>
<td><p>Load and parse the web page of the specified url (currently only supports HTML).</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">digest_webpage</span></code></p></td>
<td><p>Digest the content of a already loaded web page (currently only supports HTML).</p></td>
</tr>
<tr class="row-odd"><td><p>File</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">create_file</span></code></p></td>
<td><p>Create a new file at a specified path, optionally with initial content.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">delete_file</span></code></p></td>
<td><p>Delete a file specified by a file path.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">move_file</span></code></p></td>
<td><p>Move or rename a file from one path to another.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">create_directory</span></code></p></td>
<td><p>Create a new directory at a specified path.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">delete_directory</span></code></p></td>
<td><p>Delete a directory and all its contents.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">move_directory</span></code></p></td>
<td><p>Move or rename a directory from one path to another.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">read_text_file</span></code></p></td>
<td><p>Read and return the content of a text file.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write_text_file</span></code></p></td>
<td><p>Write text content to a file at a specified path.</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">read_json_file</span></code></p></td>
<td><p>Read and parse the content of a JSON file.</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">write_json_file</span></code></p></td>
<td><p>Serialize a Python object to JSON and write to a file.</p></td>
</tr>
<tr class="row-odd"><td><p><em>More services coming soon</em></p></td>
<td><p></p></td>
<td><p>More service functions are in development and will be added to AgentScope to further enhance its capabilities.</p></td>
</tr>
</tbody>
</table>
<p>About each service function, you can find detailed information in the
<a class="reference external" href="https://modelscope.github.io/agentscope/">API document</a>.</p>
</section>
<section id="how-to-use-service-functions">
<h2>How to use Service Functions<a class="headerlink" href="#how-to-use-service-functions" title="Link to this heading"></a></h2>
<p>AgentScope provides two service classes for Service functions,
<code class="docutils literal notranslate"><span class="pre">ServiceFactory</span></code> and <code class="docutils literal notranslate"><span class="pre">ServiceResponse</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ServiceFactory</span></code> is mainly used to convert general Python functions into
a form that can be directly used by large-scale models, and automatically
generate function descriptions in JSON schema format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ServiceResponse</span></code> is a subclass of a dictionary, providing a unified call
result interface for all Service functions.</p></li>
</ul>
<section id="about-service-factory">
<h3>About Service Factory<a class="headerlink" href="#about-service-factory" title="Link to this heading"></a></h3>
<p>The tools used by agents are generally of the function type. Developers
need to prepare functions that can be called directly by large models, and
provide descriptions of the functions. However, general functions often
require developers to provide some parameters (such as keys, usernames,
specific URLs, etc.), and then the large model can use them. At the same
time, it is also a tedious task to generate specific format descriptions
for multiple functions.</p>
<p>To tackle the above problems, AgentScope introduces <code class="docutils literal notranslate"><span class="pre">ServiceFactory</span></code>. For a
given Service function, it allows developers to specify some parameters,
generate a function that can be called directly by large models, and
automatically generate function descriptions based on the Docstring. Take
the Bing web search function as an example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bing_search</span><span class="p">(</span>
    <span class="n">question</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">num_results</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search question in Bing Search API and return the searching results</span>

<span class="sd">    Args:</span>
<span class="sd">        question (`str`):</span>
<span class="sd">            The search query string.</span>
<span class="sd">        api_key (`str`):</span>
<span class="sd">            The API key provided for authenticating with the Bing Search API.</span>
<span class="sd">        num_results (`int`, defaults to `10`):</span>
<span class="sd">            The number of search results to return.</span>
<span class="sd">        **kwargs (`Any`):</span>
<span class="sd">            Additional keyword arguments to be included in the search query.</span>
<span class="sd">            For more details, please refer to</span>
<span class="sd">            https://learn.microsoft.com/en-us/bing/search-apis/bing-web-search/reference/query-parameters</span>

<span class="sd">    [omitted for brevity]</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p>In the above function, <code class="docutils literal notranslate"><span class="pre">question</span></code> is the field filled in by the large model,
while <code class="docutils literal notranslate"><span class="pre">api_key</span></code> and <code class="docutils literal notranslate"><span class="pre">num_results</span></code> are the parameters that the developer needs to provide.
We use the <code class="docutils literal notranslate"><span class="pre">get</span></code> function of <code class="docutils literal notranslate"><span class="pre">ServiceFactory</span></code> to process it:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">agentscope.service</span> <span class="kn">import</span> <span class="n">ServiceFactory</span>

<span class="n">func</span><span class="p">,</span> <span class="n">func_intro</span> <span class="o">=</span> <span class="n">ServiceFactory</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
    <span class="n">bing_search</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;xxx&quot;</span><span class="p">,</span>
    <span class="n">num_results</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>In the above code, the <code class="docutils literal notranslate"><span class="pre">func</span></code> generated by ServiceFactory is equivalent to the following function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bing_search</span><span class="p">(</span><span class="n">question</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Search question in Bing Search API and return the searching results</span>

<span class="sd">    Args:</span>
<span class="sd">        question (`str`):</span>
<span class="sd">            The search query string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">bing_search</span><span class="p">(</span><span class="n">question</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s2">&quot;xxx&quot;</span><span class="p">,</span> <span class="n">num_results</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>The generated JSON schema format is as follows, which can be directly used
in the <code class="docutils literal notranslate"><span class="pre">tools</span></code> field of the OpenAI API.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># print(func_intro)</span>
<span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;function&quot;</span><span class="p">,</span>
    <span class="s2">&quot;function&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;bing_search&quot;</span><span class="p">,</span>
        <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Search question in Bing Search API and return the searching results&quot;</span><span class="p">,</span>
        <span class="s2">&quot;parameters&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
            <span class="s2">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;question&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;The search query string.&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;required&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;question&quot;</span>
            <span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note</strong>:
The description of the function and arguments are extracted from
its docstring automatically, which should be well-formatted in
<strong>Google style</strong>. Otherwise, their descriptions in the returned
dictionary will be empty.</p>
<p><strong>Suggestions</strong>:</p>
<ol class="arabic simple">
<li><p>The name of the service function should be self-explanatory,
so that the agent can understand the function and use it properly.</p></li>
<li><p>The typing of the arguments should be provided when defining
the function (e.g. <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">func(a:</span> <span class="pre">int,</span> <span class="pre">b:</span> <span class="pre">str,</span> <span class="pre">c:</span> <span class="pre">bool)</span></code>), so that
the agent can specify the arguments properly.</p></li>
</ol>
</section>
<section id="about-serviceresponse">
<h3>About ServiceResponse<a class="headerlink" href="#about-serviceresponse" title="Link to this heading"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ServiceResponse</span></code> is a wrapper for the execution results of the services,
containing two fields, <code class="docutils literal notranslate"><span class="pre">status</span></code> and <code class="docutils literal notranslate"><span class="pre">content</span></code>. When the Service function
runs to completion normally, <code class="docutils literal notranslate"><span class="pre">status</span></code> is <code class="docutils literal notranslate"><span class="pre">ServiceExecStatus.SUCCESS</span></code>, and
<code class="docutils literal notranslate"><span class="pre">content</span></code> is the return value of the function. When an error occurs during
execution, <code class="docutils literal notranslate"><span class="pre">status</span></code> is <code class="docutils literal notranslate"><span class="pre">ServiceExecStatus.Error</span></code>, and <code class="docutils literal notranslate"><span class="pre">content</span></code> contains
the error message.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ServiceResponse</span><span class="p">(</span><span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to wrap the execution results of the services&quot;&quot;&quot;</span>

    <span class="fm">__setattr__</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__setitem__</span>
    <span class="fm">__getattr__</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="fm">__getitem__</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="n">ServiceExecStatus</span><span class="p">,</span>
        <span class="n">content</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor of ServiceResponse</span>

<span class="sd">        Args:</span>
<span class="sd">            status (`ServiceExeStatus`):</span>
<span class="sd">                The execution status of the service.</span>
<span class="sd">            content (`Any`)</span>
<span class="sd">                If the argument`status` is `SUCCESS`, `content` is the</span>
<span class="sd">                response. We use `object` here to support various objects,</span>
<span class="sd">                e.g. str, dict, image, video, etc.</span>
<span class="sd">                Otherwise, `content` is the error message.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status</span> <span class="o">=</span> <span class="n">status</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>

    <span class="c1"># [omitted for brevity]</span>
</pre></div>
</div>
</section>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">agentscope.service</span> <span class="kn">import</span> <span class="n">ServiceResponse</span>
<span class="kn">from</span> <span class="nn">agentscope.agents</span> <span class="kn">import</span> <span class="n">AgentBase</span>


<span class="k">def</span> <span class="nf">create_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ServiceResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a file and write content to it.</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str): The path to the file to be created.</span>
<span class="sd">        content (str): The content to be written to the file.</span>

<span class="sd">    Returns:</span>
<span class="sd">        ServiceResponse: A boolean indicating success or failure, and a</span>
<span class="sd">        string containing any error message (if any), including the error type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># ... [omitted for brevity]</span>


<span class="k">class</span> <span class="nc">YourAgent</span><span class="p">(</span><span class="n">AgentBase</span><span class="p">):</span>
    <span class="c1"># ... [omitted for brevity]</span>

    <span class="k">def</span> <span class="nf">reply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="c1"># ... [omitted for brevity]</span>

        <span class="c1"># construct a prompt to ask the agent to provide the parameters in JSON format</span>
        <span class="n">prompt</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;To complete the user request</span><span class="se">\n</span><span class="s2">```</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;content&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">```</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Please provide the necessary parameters in JSON format for the &quot;</span>
            <span class="s2">&quot;function:</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Function: </span><span class="si">{</span><span class="n">create_file</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="s2">&quot;Description: Create a file and write content to it.</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># add detailed information about the function parameters</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">create_file</span><span class="p">)</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="n">params_prompt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;- </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">param</span><span class="o">.</span><span class="n">annotation</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">): &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;(default: &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">default</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;)&#39;</span><span class="k">if</span><span class="w"> </span><span class="n">param</span><span class="o">.</span><span class="n">default</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">inspect</span><span class="o">.</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">parameters</span>
        <span class="p">)</span>
        <span class="n">prompt</span> <span class="o">+=</span> <span class="n">params_prompt</span>

        <span class="c1"># get the model response</span>
        <span class="n">model_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>

        <span class="c1"># parse the model response and call the create_file function</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">kwargs</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">model_response</span><span class="p">)</span>
            <span class="n">create_file</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># Error handling</span>
            <span class="k">pass</span>

        <span class="c1"># ... [omitted for brevity]</span>
</pre></div>
</div>
<p><a class="reference internal" href="#service-en">[Return to Top]</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="203-model.html" class="btn btn-neutral float-left" title="Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="205-memory.html" class="btn btn-neutral float-right" title="Memory" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Alibaba Tongyi Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>