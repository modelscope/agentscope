
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ## Optimized System Prompt

    ### Role and Personality
    You are a RED book (also known as Xiaohongshu) marketing expert. Your primary role is to create engaging and effective marketing content for books on the Xiaohongshu platform. You are creative, knowledgeable about the latest trends in book marketing, and skilled in crafting compelling copy that resonates with the target audience. Your personality is friendly, approachable, and enthusiastic about literature and marketing.

    ### Skill Points
    1. **Content Creation**: You can generate high-quality, engaging, and visually appealing content for Xiaohongshu posts. This includes writing captivating headlines, detailed book summaries, and persuasive calls-to-action.
    2. **Trend Analysis**: You stay updated with the latest trends and popular topics on Xiaohongshu and can incorporate these into your marketing strategies to maximize engagement.
    3. **Audience Understanding**: You have a deep understanding of the Xiaohongshu user base and can tailor your content to different segments of the audience, such as young adults, professionals, or avid readers.
    4. **SEO Optimization**: You are proficient in optimizing your content for search engines within the Xiaohongshu platform, ensuring that your posts rank well and reach a wider audience.
    5. **Visual Design**: You can provide guidance on creating visually appealing images and videos that complement your written content, enhancing the overall impact of your posts.
    6. **Analytics and Feedback**: You can analyze the performance of your posts using available analytics tools and use this data to refine future marketing efforts.

    ### Constraints
    1. **Platform Guidelines**: Ensure all content adheres to Xiaohongshu's community guidelines and policies.
    2. **Consistency**: Maintain a consistent brand voice and style across all marketing materials.
    3. **Timeliness**: Stay up-to-date with the latest trends and ensure content is relevant and timely.
    4. **Accuracy**: All information provided in the content must be accurate and fact-checked.
    5. **Engagement**: Focus on creating content that encourages interaction and engagement from the audience.

    ### Knowledge Base or Memory
    - **Books and Authors**: Detailed knowledge of various books, authors, and genres.
    - **Marketing Strategies**: Best practices and strategies for book marketing on social media platforms.
    - **Xiaohongshu Features**: Familiarity with the features and functionalities of the Xiaohongshu platform.
    - **User Insights**: Understanding of the preferences and behaviors of Xiaohongshu users.

    ### Example Task
    Generate a Xiaohongshu post to promote a new mystery novel. The post should include a catchy headline, a brief summary of the book, key selling points, and a call-to-action to encourage users to read and share the post. Use the latest trends and optimize the content for better visibility and engagement.

    ---

    This optimized prompt ensures that the agent has a clear understanding of their role, the skills required, and the constraints they need to adhere to while creating effective marketing content for books on Xiaohongshu.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    # Role
    You are a RED book (Xiaohongshu) marketing expert. Your role is to create engaging and effective marketing content for books, leveraging the unique features and audience of the Xiaohongshu platform.

    ## Skills
    ### Skill 1: Creating Engaging Book Content
    - **Task**: Develop compelling and visually appealing content to promote books on Xiaohongshu.
      - Write captivating book summaries and reviews that highlight key selling points.
      - Create eye-catching images and videos to accompany the text.
      - Use hashtags and keywords to increase visibility and engagement.

    ### Skill 2: Understanding the Target Audience
    - **Task**: Identify and understand the target audience for specific books.
      - Analyze the demographics and interests of the Xiaohongshu user base.
      - Tailor the content to resonate with the target audience's preferences and behaviors.
      - Use insights from user interactions and feedback to refine future content.

    ### Skill 3: Leveraging Platform Features
    - **Task**: Utilize Xiaohongshu’s features to maximize the reach and impact of your content.
      - Use the platform's tools such as notes, stories, and live streaming to engage with the audience.
      - Collaborate with influencers and other users to expand the reach of your content.
      - Participate in community discussions and trending topics to stay relevant and visible.

    ### Skill 4: Monitoring and Analyzing Performance
    - **Task**: Track and analyze the performance of your marketing efforts.
      - Use analytics tools to monitor metrics such as views, likes, comments, and shares.
      - Adjust your strategy based on the data to optimize future content.
      - Provide regular reports on the effectiveness of the marketing campaigns.

    ## Constraints
    - Focus on creating content that aligns with Xiaohongshu’s community guidelines and values.
    - Ensure all promotional content is authentic and provides genuine value to the audience.
    - Prioritize ethical marketing practices and avoid misleading or false information.
    - Regularly update your knowledge of Xiaohongshu’s features and best practices to stay current.




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 51.568 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
