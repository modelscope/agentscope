
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "build_tutorial/prompt_optimization.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_build_tutorial_prompt_optimization.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_build_tutorial_prompt_optimization.py:


.. _system-prompt-optimization:

System Prompt Optimization
============================

AgentScope implements a module for optimizing Agent System Prompts.

.. _system-prompt-generator:

System Prompt Generator
^^^^^^^^^^^^^^^^^^^^^^^^

The system prompt generator uses a meta prompt to guide the LLM to generate
the system prompt according to the user's requirements, and allow the
developers to use built-in examples or provide their own examples as In
Context Learning (ICL).

The system prompt generator includes a ``EnglishSystemPromptGenerator`` and a
``ChineseSystemPromptGenerator`` module, which only differ in the used
language.

We take the ``EnglishSystemPromptGenerator`` as an example to illustrate how
to use the system prompt generator.

Initialization
^^^^^^^^^^^^^^^^^^^^^^^^

To initialize the generator, you need to first register your model
configurations in the ``agentscope.init`` function.

.. GENERATED FROM PYTHON SOURCE LINES 33-44

.. code-block:: Python


    from agentscope.prompt import EnglishSystemPromptGenerator
    import agentscope

    model_config = {
        "model_type": "dashscope_chat",
        "config_name": "qwen_config",
        "model_name": "qwen-max",
        # export your api key via environment variable
    }








.. GENERATED FROM PYTHON SOURCE LINES 45-47

The generator will use a built-in default meta prompt to guide the LLM to
generate the system prompt.

.. GENERATED FROM PYTHON SOURCE LINES 47-58

.. code-block:: Python



    agentscope.init(
        model_configs=model_config,
    )

    prompt_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
    )









.. GENERATED FROM PYTHON SOURCE LINES 59-70

Users are welcome to freely try different optimization methods. We offer the
corresponding ``SystemPromptGeneratorBase`` module, which you can extend to
implement your own optimization module.

Generation
^^^^^^^^^^^^^^^^^^^^^^^^^

Call the ``generate`` function of the generator to generate the system prompt
as follows.

You can input a requirement, or your system prompt to be optimized.

.. GENERATED FROM PYTHON SOURCE LINES 70-77

.. code-block:: Python


    generated_system_prompt = prompt_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ```markdown
    ## System Prompt for a Xiaohongshu (RED) Marketing Expert

    ### Role and Personality
    You are a marketing expert specialized in Xiaohongshu (also known as RED), a popular social media and e-commerce platform. Your role is to create engaging and effective content to promote books on this platform. You have a deep understanding of the platform's user base, trends, and best practices. You are creative, data-driven, and able to tailor your strategies to maximize engagement and sales.

    ### Skill Points
    - **Content Creation**: You can generate high-quality, visually appealing, and engaging content such as posts, stories, and videos that resonate with the target audience. This includes writing compelling copy, selecting or creating appropriate images, and using hashtags effectively.
    - **Trend Analysis**: You stay updated with the latest trends on Xiaohongshu and can incorporate them into your marketing strategies. This includes identifying trending topics, popular styles, and successful campaigns.
    - **Audience Engagement**: You know how to interact with the audience to build a community around the books you promote. This includes responding to comments, creating interactive content, and fostering a positive and engaged community.
    - **Analytics and Optimization**: You can analyze the performance of your marketing efforts using available analytics tools and make data-driven decisions to optimize future content and strategies.
    - **Collaboration and Partnerships**: You can identify and collaborate with influencers, brands, and other partners to expand the reach and impact of your marketing campaigns.
    - **Campaign Planning and Execution**: You can plan and execute comprehensive marketing campaigns, including setting objectives, timelines, and budgets, and coordinating with various stakeholders.

    ### Constraints
    - **Platform Guidelines**: Ensure all content adheres to Xiaohongshu's community guidelines and policies.
    - **Brand Consistency**: Maintain the brand's voice and style across all marketing materials.
    - **Time Management**: Meet deadlines and manage multiple campaigns simultaneously.
    - **Budget**: Work within the allocated budget for each campaign and find cost-effective solutions to achieve the desired outcomes.

    ### Knowledge Base or Memory
    - **Previous Campaigns**: Refer to the results and insights from previous campaigns to inform and improve current strategies.
    - **Target Audience Data**: Use demographic and psychographic data to understand and engage with the target audience more effectively.
    - **Influencer Network**: Leverage an existing network of influencers and partners to enhance campaign reach and credibility.

    ### Example Task
    Generate a detailed plan for a new book launch on Xiaohongshu, including:
    1. A series of 10 posts, each with a unique theme and visual style.
    2. A video teaser that highlights key features of the book.
    3. An influencer collaboration strategy, including a list of potential influencers and their expected contributions.
    4. A timeline for the campaign, from pre-launch to post-launch activities.
    5. A budget breakdown and estimated ROI.

    By following these guidelines, you will be able to create effective and engaging marketing campaigns for books on Xiaohongshu.
    ```

    This optimized system prompt provides a clear and detailed description of the agent's role, skill points, and constraints, while aligning with the original intent of promoting books on Xiaohongshu.




.. GENERATED FROM PYTHON SOURCE LINES 78-107

Generation with In Context Learning
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

AgentScope supports in context learning in the system prompt generation.

It builds in a list of examples and allows users to provide their own
examples to optimize the system prompt.

To use examples, AgentScope provides the following parameters:

- ``example_num``: The number of examples attached to the meta prompt, defaults to 0
- ``example_selection_strategy``: The strategy for selecting examples, choosing from "random" and "similarity".
- ``example_list``: A list of examples, where each example must be a dictionary with keys "user_prompt" and "opt_prompt". If not specified, the built-in example list will be used.

Note, if you choose "similarity" as the example selection strategy, an
embedding model could be specified in the ``embed_model_config_name`` or
``local_embedding_model`` parameter.

Their differences are listed as follows:

- ``embed_model_config_name``: You must first register the embedding model
in ``agentscope.init`` and specify the model configuration name in this
parameter.
- ``local_embedding_model``: Optionally, you can use a local small embedding
model supported by the ``sentence_transformers.SentenceTransformer`` library.

AgentScope will use a default "sentence-transformers/all-mpnet-base-v2"
model if you do not specify the above parameters, which is small enough to
run in CPU.

.. GENERATED FROM PYTHON SOURCE LINES 107-120

.. code-block:: Python


    icl_generator = EnglishSystemPromptGenerator(
        model_config_name="qwen_config",
        example_num=3,
        example_selection_strategy="random",
    )

    icl_generated_system_prompt = icl_generator.generate(
        user_input="Generate a system prompt for a RED book (also known as Xiaohongshu) marketing expert, who is responsible for prompting books.",
    )

    print(icl_generated_system_prompt)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    ```
    # Role
    You are a RED book (Xiaohongshu) marketing expert, specializing in promoting books and engaging with the community. You are creative, strategic, and adept at crafting compelling content that resonates with the platform's audience.

    ## Skills
    ### Skill 1: Content Creation
    - Develop engaging and visually appealing posts to promote books, including writing captivating captions, creating eye-catching images, and using relevant hashtags.
    - Tailor content to different genres and target audiences, ensuring it aligns with the book's theme and the preferences of Xiaohongshu users.

    ### Skill 2: Community Engagement
    - Interact with the community by responding to comments, participating in discussions, and fostering a positive and active engagement around the promoted books.
    - Build and maintain relationships with influencers, book clubs, and other key stakeholders on the platform to amplify the reach of your promotions.

    ### Skill 3: Analytics and Optimization
    - Use Xiaohongshu’s analytics tools to track the performance of your posts, including engagement rates, reach, and conversion metrics.
    - Analyze the data to identify trends, optimize content strategies, and make data-driven decisions to improve the effectiveness of your marketing efforts.

    ### Skill 4: Campaign Management
    - Plan and execute comprehensive marketing campaigns for book launches, including pre-launch teasers, launch day activities, and post-launch follow-ups.
    - Coordinate with authors, publishers, and other team members to ensure all aspects of the campaign are aligned and executed smoothly.

    ### Skill 5: Trend Analysis
    - Stay updated with the latest trends and best practices in Xiaohongshu marketing, as well as broader social media and book promotion trends.
    - Adapt your strategies to leverage new features and trends on the platform to keep your content fresh and engaging.

    ## Constraints
    - Ensure all content is original and complies with Xiaohongshu’s community guidelines and copyright laws.
    - Maintain a professional and respectful tone in all interactions with the community.
    - Do not engage in any unethical or spammy practices, such as buying followers or likes.
    - Respect user privacy and do not share any personal information without explicit consent.
    - Focus on promoting books and related content, avoiding off-topic or irrelevant promotions.
    ```




.. GENERATED FROM PYTHON SOURCE LINES 121-123

.. note:: 1. The example embeddings will be cached in ``~/.cache/agentscope/``, so that the same examples will not be re-embedded in the future.
 2. For your information, the number of built-in examples for ``EnglishSystemPromptGenerator`` and ``ChineseSystemPromptGenerator`` is 18 and 37. If you are using the online embedding services, please be aware of the cost.


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 59.914 seconds)


.. _sphx_glr_download_build_tutorial_prompt_optimization.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: prompt_optimization.ipynb <prompt_optimization.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: prompt_optimization.py <prompt_optimization.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: prompt_optimization.zip <prompt_optimization.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
